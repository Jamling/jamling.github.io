<!DOCTYPE html>
<html lang="zh" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<head>
  <meta charset="utf-8">
  <title>Excel VBA基础实例教程</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="其它,Excel VBA基础实例教程">
  <meta name="description" content="

VBA简介VBAVBA (Visual Basic for Application)，是一种应用程序自动化语言，所谓的应用程序自动化，就是通过程序或者脚本（VBS）让应用程序（Word, Excel）自动化完成一些工作（自动填充内容，自动计算等）。">
   

  <meta name="og:type" content="article">
  <meta name="og:site_name" content="静勤居">
  <meta name="og:image" content="https://www.ieclipse.cn/image/logo.png">
  <meta name="og:title" content="Excel VBA基础实例教程">
  <meta name="og:url" content="https://www.ieclipse.cn/2016/05/13/other/tech-vba-guide/">
  <meta name="og:description" content="

VBA简介VBAVBA (Visual Basic for Application)，是一种应用程序自动化语言，所谓的应用程序自动化，就是通过程序或者脚本（VBS）让应用程序（Word, Excel）自动化完成一些工作（自动填充内容，自动计算等）。">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="静勤居">
  <meta name="twitter:image" content="https://www.ieclipse.cn/image/logo.png">
  <meta name="twitter:title" content="Excel VBA基础实例教程">
  <meta name="twitter:creator" content="@JamlingLi">
  <meta name="twitter:description" content="

VBA简介VBAVBA (Visual Basic for Application)，是一种应用程序自动化语言，所谓的应用程序自动化，就是通过程序或者脚本（VBS）让应用程序（Word, Excel）自动化完成一些工作（自动填充内容，自动计算等）。">

  <!-- Canonical links -->
  <link rel="canonical" href="https://www.ieclipse.cn/2016/05/13/other/tech-vba-guide/index.html">
  <!-- Alternative links -->
  <!-- CSS and JS-->
  
<script src="//cdn.bootcss.com/jquery/2.2.0/jquery.min.js"></script>


<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">


<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">


<script src="//cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<script src="//cdn.staticfile.org/sidr/2.2.1/jquery.sidr.min.js"></script>


<script src="/js/jquery.bootstrap-autohidingnavbar.min.js"></script>


<link rel="stylesheet" href="//cdn.staticfile.org/sidr/2.2.1/stylesheets/jquery.sidr.dark.min.css">


<link rel="stylesheet" href="//cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css">


<script src="//cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>


<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/tonsky/FiraCode@2/distr/fira_code.css">


<script src="//cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>


<script src="//cdn.staticfile.org/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


<link rel="stylesheet" href="//cdn.staticfile.org/fancybox/2.1.5/jquery.fancybox.min.css">


<link rel="stylesheet" href="//cdn.staticfile.org/fancybox/2.1.5/helpers/jquery.fancybox-buttons.css">


<script src="//cdn.staticfile.org/fancybox/2.1.5/helpers/jquery.fancybox-buttons.js"></script>


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">


<link rel="stylesheet" href="/css/nova_font.css">


<link rel="stylesheet" href="/css/bs/nova.css">


<script src="//unpkg.com/leancloud-storage@4.13.2/dist/av-min.js"></script>


<script src="/js/leancloud.js"></script>


  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Jamling's Blog and Project Site" type="application/atom+xml">
  <link rel="shortcut icon" href="/image/favicon.ico" type="image/x-icon" />
  <script>
        lc.init({
          appId : 'C45xzaBLva5G5IfKxOwGXuVb-gzGzoHsz',
          appKey : 'QwGBjKlSYOBtjMa5aTGeO3cb',
          serverURL : 'https://lc.ieclipse.cn'
        }, {
          xid : '1173caa5a2793a07589a12dc3b079b4c',
          url : '2016/05/13/other/tech-vba-guide/',
          title : 'Excel VBA基础实例教程'
        }, {
          counterTable: '',
          commentTable: '',
          donateTable: ''
        });
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <!-- header -->
  <header id="body-header">
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top">
    <div class="container container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse_" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="/" id="logo"><img src="/image/logo.png" height="50" alt="logo"></a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
        <li><a href="/" class="main-nav">首页</a></li><li><a href="/p/" class="main-nav">项目</a></li><li><a href="/categories/" class="main-nav">分类</a></li><li><a href="/archives/" class="main-nav">归档</a></li><li><a href="/donate/" class="main-nav">捐赠墙</a></li><li><a href="/about/" class="main-nav">关于</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">语言 <span class="caret"></span></a>
            <ul class="dropdown-menu animated fadeInDown faster">
              <li><a href="/2016/05/13/other/tech-vba-guide/">简体中文</a></li>
              
              <li><a href="/en/2016/05/13/other/tech-vba-guide/">English</a></li>
              
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

  <!-- main -->
  
<div class="container container-fluid">
<div class="row">
  <div class="col-sx-12 col-sm-8 col-md-9 col-lg-9">
    
<article class="article post" itemscope="itemscope" itemtype="http://schema.org/Article">
  <header class="article-header">
    <div class="page-path"><span class="post-category"><span class="glyphicon glyphicon-folder-close" aria-hidden="true"></span>当前路径：<a class="category-item" href="/">文章</a><a class="category-item" href="/categories/other/">其它</a><a class="category-item">Excel VBA基础实例教程</a></span></div>
    <div class="divider"></div>
      <h1 class="article-title" itemprop="name headline">Excel VBA基础实例教程</h1>
    <div class="post-header clearfix">
      <span class="post-date"><span class="hidden-xs icon nova-calendar">发表于</span>
      <time datetime="2016-05-13T08:32:00.000Z" itemprop="datePublished"><time datetime="2016-05-13T08:32:00.000Z">2016-05-13</time></time>
      </span>
      
      <span class="post-share xxx-count" data-xid="1173caa5a2793a07589a12dc3b079b4c" data-title="Excel VBA基础实例教程" data-url="2016/05/13/other/tech-vba-guide/">
        <a href="#share" class="icon nova-share">
          <span class="hidden-xs">分享</span><span class="jiathis_counter_style"></span>
        </a>
        <a href="#comment" class="icon nova-bubbles comment-count">
          <span class="count"></span><span class="hidden-xs">评论</span>
        </a>
        <!--<a href="#like" class="icon nova-heart2-full"><span class="count" id="changyan_parti_unit"></span><span class="hidden-xs">喜欢</span></a>-->
        <a href="#" class="icon nova-eye view-count">
          <span class="count"></span><span class="hidden-xs">次阅读</span>
        </a>
      </span>
    </div>
    <div class="divider"></div>
    <meta content="2016-05-13T08:32:00.000Z" itemprop="datePublished">
  </header>
  <div class="article-content" itemprop="articleBody">
  
    <script src="http://cdn.bootcss.com/highlight.js/9.1.0/languages/vbscript.min.js" ></script>

<h1 id="VBA简介"><a href="#VBA简介" class="headerlink" title="VBA简介"></a>VBA简介</h1><h2 id="VBA"><a href="#VBA" class="headerlink" title="VBA"></a>VBA</h2><p>VBA (Visual Basic for Application)，是一种应用程序自动化语言，所谓的应用程序自动化，就是通过程序或者脚本（VBS）让应用程序（Word, Excel）自动化完成一些工作（自动填充内容，自动计算等）。</p>
<span id="more"></span>

<h2 id="宏与VBA"><a href="#宏与VBA" class="headerlink" title="宏与VBA"></a>宏与VBA</h2><p>宏其实是Excel自动生成的VBA代码。<br>可以通过菜单栏工具→宏→录制新宏，然后点击工具栏中字体颜色设置颜色为红色，设置对齐方式为居中对齐，再点击停止宏。<br>再选择其它单元格，点击菜单栏工具→宏→选择刚才录制的宏。这样所选择的单元格都变成红色字体，居中对齐了。</p>
<p>所以，通过宏，相信大家对VBA有了更深入的了解了吧？没错就是自动化操作。让原本相对相对复杂的操作通过VBA包装起来，再让电脑自动去完成这些操作。</p>
<p>有人要问了，你刚才讲到的例子，可以用格式刷完成，或者多选单元格之后再一起设置也可以呀。确实可以，不过上面宏示例，只是一个非常简单的例子。再复杂一点的呢？比如一份Excel中有一个Sheet，是比较隐私的，需要输入密码才能查看，或者完成一些Excel公式不支持的复杂运算。这时候VBA的强大之处就体现出来啦。</p>
<p>是不是学好了VBA之后，就不用再使用宏了呢？也不是，通过查看录制的宏，可以看到好多VBA操作Excel的例子，比如使用哪些对象，执行什么操作啦，一目了然。如果对Excel内建对象不是很熟的话，查看宏代码不失为一个学习VBA的好办法。</p>
<h1 id="教程目的"><a href="#教程目的" class="headerlink" title="教程目的"></a>教程目的</h1><p>本文档的目的在于让读者对VBA有一个初步的概念，通过练习编写一个个人所得税计算器来一步一步学习VBA。</p>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>首先，你需要安装Office Excel，然后新建一个新建一个Excel文档，重命名为个人所得税计算器。</p>
<p><strong>注：本教程使用的Office为Office 2003简体中文精简版。如果遇到与本文档不符合的地方，请自行解决。</strong></p>
<p>其次，通过基本的Excel操作，将表格设计成个人所得税计算器，如下图所示：</p>
<img src="/2016/05/13/other/tech-vba-guide/image001.png" class="">

<p>以上基本的Excel操作，相信是个用电脑工作的人，应该都会的。<br>下面，通过学习VBA，来开启Excel的高级应用吧。</p>
<h1 id="VBA-for-Excel"><a href="#VBA-for-Excel" class="headerlink" title="VBA for Excel"></a>VBA for Excel</h1><h2 id="VBA编辑器简介"><a href="#VBA编辑器简介" class="headerlink" title="VBA编辑器简介"></a>VBA编辑器简介</h2><h3 id="打开VBA编辑器"><a href="#打开VBA编辑器" class="headerlink" title="打开VBA编辑器"></a>打开VBA编辑器</h3><p>菜单栏：视图→工具栏→Visual Basic，打开VB工具栏（后面的Visual Basic，一律简称为VB）</p>
<img src="/2016/05/13/other/tech-vba-guide/image003.png" class="">

<p>点击VB编辑器图标，打开VB编辑器</p>
<img src="/2016/05/13/other/tech-vba-guide/image005.png" class="">

<p>打开后的界面如下</p>


<p>下面简单介绍一下VB编辑器各个部分</p>
<h3 id="工程资源管理器"><a href="#工程资源管理器" class="headerlink" title="工程资源管理器"></a>工程资源管理器</h3><p>管理工程资源，如窗体，模块，类模块，还可以导入，导出窗体，模块等，在这里，重点提一下模块与类模块，个人理解，类模块就是单个类，主要用于面向对象的类的定义，而模块主要用于流程的控制。这仅是个人的理解，不明白的人，可以自行百度VBA类模块等关键词。</p>
<h3 id="属性窗口"><a href="#属性窗口" class="headerlink" title="属性窗口"></a>属性窗口</h3><p>显示当前所选对象的属性，比如上图中，我所选的是第一个sheet（2012个人所得税计算器），属性窗口中的Name属性即为2012个人所得税计算器，当然，属性除了给你看之外，你还可以编辑属性值哟，不信，你试试将Name属性值变更为“个体工商经营所得税计算器”试试。</p>
<h3 id="代码窗口"><a href="#代码窗口" class="headerlink" title="代码窗口"></a>代码窗口</h3><p>个人理解，这里就是编辑器啦，只不过，可以切换成代码模式（代码窗口）和可视化设计模式（对象窗口）两种模式，你可以在此编辑程序的代码或设计程序窗口。</p>
<p>可视化设计模式只针对窗体有效哦，你可以双击工程资源管理器中的FormCalculator窗体试试，默认打开的就是对象窗口哦，如下图所示：</p>
<img src="/2016/05/13/other/tech-vba-guide/image009.png" class="">
<p>不过因为我们研究的是VBA，所以，我们不需要画应用程序的窗口，直接使用Excel表格就可以完成了，如果你感兴趣的话，可以将工程导出，然后使用VB创建.exe应用程序哦。</p>
<h3 id="立即窗口"><a href="#立即窗口" class="headerlink" title="立即窗口"></a>立即窗口</h3><p>如果你学过其它计算机语言的话，可能会很奇怪，为什么叫这个名字，其实它就是调试程序的输出窗口，类似于C++的输出窗口，Java IDE的Console。代码中使用Debug.Print输出的内容都会在此窗口打印出来。</p>
<h3 id="本地窗口"><a href="#本地窗口" class="headerlink" title="本地窗口"></a>本地窗口</h3><p>此窗口也跟调试程序有关的，在调试程序的过程中，此窗口显示当前范围的变量的值哦，对调试程序来说，有非常大的帮助呢。</p>
<h3 id="调试工具栏"><a href="#调试工具栏" class="headerlink" title="调试工具栏"></a>调试工具栏</h3><p>为什么要调试呢？就算是顶级的程序员，也不可能保证一次写好代码，而且永不出错。调试的目的在于理解程序的运行，分析及找出bug原因，然后再加以修正，来保证代码的准确无误地按照我们的期望来执行。<br>所以调试是使用非常频繁的，大家可以通过菜单栏：将视图→工具栏→调试勾选上，将它显示在工具栏上。<br>调试可以分单步调试，过程调试等等。具体的操作，请自行体会。</p>
<p>提示：可以通过菜单栏→编译工程，来检查整个工程是否能顺利编译通过。因为VB编辑器没有像其它语言编辑器自动侦错，自动完成，语法检查那样的高级功能（有是有一点，就是功能不够强大），比如你拼错了一个变量，代码编辑器并不会立即告诉你。需要你运行过程中才提示，而且就算是提示，给的错误信息也不准确，我刚开始学习的时候，也因此烦恼了好一阵。刚开始写的时候，及时写，及时编译，还是很有必要的。</p>
<h2 id="VBA语法"><a href="#VBA语法" class="headerlink" title="VBA语法"></a>VBA语法</h2><p>在讲到这一节的时候，我有点纠结，因为一门计算机语言的语法是比较复杂的，所以，限于篇幅，我还是只作简单的介绍，详细的请自行参考某些资料，不过与其它部分（如前面的VBA简介）不同的是，要想学好VBA，其语法肯定是必不可少的重要步骤。就像学习英语一样，如果不熟悉其语法，你就没法表达出英语语境下的意思，别人也无法理解你。对于计算机，它只是一台机器，所以，你必须严格的按照其语法来写代码，计算机才能认识你写的代码，并执行它。</p>
<p>在VB&#x2F;VBA中，是使用VBScript(VBS)来写代码的，VBScript是一种脚本语言，如果有其它计算机语言基础的话，那么学习VBS，不算一件难事。</p>
<p><em>注：关于VBS学习资料，可以在网上搜索并下载《VBSCRIPT 速查手册.chm》</em></p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>VBScript 只有一种数据类型，称为 Variant。Variant 是一种特殊的数据类型，根据使用的方式，它可以包含不同类别的信息。因为 Variant 是 VBScript 中唯一的数据类型，所以它也是 VBScript 中所有函数的返回值的数据类型。</p>
<p>最简单的 Variant 可以包含数字或字符串信息。Variant 用于数字上下文中时作为数字处理，用于字符串上下文中时作为字符串处理。这就是说，如果使用看起来象是数字的数据，则 VBScript 会假定其为数字并以适用于数字的方式处理。与此类似，如果使用的数据只可能是字符串，则 VBScript 将按字符串处理。当然，也可以将数字包含在英文引号 (“ “) 中使其成为字符串。</p>
<h4 id="Variant-子类型"><a href="#Variant-子类型" class="headerlink" title="Variant 子类型"></a>Variant 子类型</h4><p>除简单数字或字符串以外，Variant 可以进一步区分数值信息的特定含义。例如使用数值信息表示日期或时间。此类数据在与其他日期或时间数据一起使用时，结果也总是表示为日期或时间。当然，从 Boolean 值到浮点数，数值信息是多种多样的。Variant 包含的数值信息类型称为子类型。大多数情况下，可将所需的数据放进 Variant 中，而 Variant 也会按照最适用于其包含的数据的方式进行操作。</p>
<p>下表显示 Variant 包含的数据子类型：</p>
<table>
<thead>
<tr>
<th>子类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Empty</td>
<td>未初始化的 Variant。对于数值变量，值为 0；对于字符串变量，值为零长度字符串 (“”)。</td>
</tr>
<tr>
<td>Null</td>
<td>不包含任何有效数据的 Variant。</td>
</tr>
<tr>
<td>Boolean</td>
<td>包含 True 或 False。</td>
</tr>
<tr>
<td>Byte</td>
<td>包含 0 到 255 之间的整数。</td>
</tr>
<tr>
<td>Integer</td>
<td>包含 -32,768 到 32,767 之间的整数。</td>
</tr>
<tr>
<td>Currency</td>
<td>-922,337,203,685,477.5808 到 922,337,203,685,477.5807。</td>
</tr>
<tr>
<td>Long</td>
<td>包含 -2,147,483,648 到 2,147,483,647 之间的整数。</td>
</tr>
<tr>
<td>Single</td>
<td>包含单精度浮点数，负数范围从 -3.402823E38 到 -1.401298E-45，正数范围从 1.401298E-45 到 3.402823E38。</td>
</tr>
<tr>
<td>Double</td>
<td>包含双精度浮点数，负数范围从 -1.79769313486232E308 到 -4.94065645841247E-324，正数范围从 4.94065645841247E-324 到 1.79769313486232E308。</td>
</tr>
<tr>
<td>Date (Time)</td>
<td>包含表示日期的数字，日期范围从公元 100 年 1 月 1 日到公元 9999 年 12 月 31 日。</td>
</tr>
<tr>
<td>String</td>
<td>包含变长字符串，最大长度可为 20 亿个字符。</td>
</tr>
<tr>
<td>Object</td>
<td>包含对象。</td>
</tr>
<tr>
<td>Error</td>
<td>包含错误号。</td>
</tr>
</tbody></table>
<p>您可以使用转换函数来转换数据的子类型。另外，可使用 VarType 函数返回数据的 Variant 子类型。</p>
<h3 id="变量定义"><a href="#变量定义" class="headerlink" title="变量定义"></a>变量定义</h3><p>变量是一种使用方便的占位符，用于引用计算机内存地址，该地址可以存储 Script 运行时可更改的程序信息。在 VBScript 中只有一个基本数据类型，即 Variant，因此所有变量的数据类型都是 Variant。</p>
<h4 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h4><p>声明变量的一种方式是使用 Dim 语句、Public 语句和 Private 语句在 Script 中显式声明变量。例如：</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Dim a ‘声明一个变量名为a的变量
Dim a As Integer ‘ 声明一个变量名为a的integer类型变量
</code></pre>
<p>声明多个变量时，使用逗号分隔变量。例如：<br><code>Dim Top, Bottom, Left, Right</code><br>对于数组的声明，可以通过变更名后面加（）来声明，例如<br><code>Dim b(2) ‘声明一个长度为3的数组</code></p>
<h4 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h4><p>对于常量，可以使用const START &#x3D; 3500来赋值<br>对于变量，可以使用“&#x3D;”来赋值，如<code>b(0) = 0 ‘数组下标起始值为0</code><br><code>a = Array(0,1,2)</code><br>对于对象，需要使用Set来赋值，如</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Dim obj As Collection ‘声明obj是一个集合对象
Set obj = new Collection ‘创建一个Collection对象并赋值给obj
</code></pre>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>VBScript 有一套完整的运算符，包括算术运算符、比较运算符、连接运算符和逻辑运算符。</p>
<p>当表达式包含多种运算符时，首先计算算术运算符，然后计算比较运算符，最后计算逻辑运算符。所有比较运算符的优先级相同，即按照从左到右的顺序计算比较运算符。算术运算符和逻辑运算符的优先级如下所示：</p>
<h4 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h4><table>
<thead>
<tr>
<th>描述</th>
<th>符号</th>
</tr>
</thead>
<tbody><tr>
<td>求幂</td>
<td>^</td>
</tr>
<tr>
<td>负号</td>
<td>-</td>
</tr>
<tr>
<td>乘</td>
<td>*</td>
</tr>
<tr>
<td>除</td>
<td>&#x2F;</td>
</tr>
<tr>
<td>整除</td>
<td>\</td>
</tr>
<tr>
<td>求余</td>
<td>Mod</td>
</tr>
<tr>
<td>加</td>
<td>+</td>
</tr>
<tr>
<td>减</td>
<td>-</td>
</tr>
<tr>
<td>字符串连接</td>
<td>&amp;</td>
</tr>
</tbody></table>
<h4 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4><table>
<thead>
<tr>
<th>描述</th>
<th>符号</th>
</tr>
</thead>
<tbody><tr>
<td>等于</td>
<td>&#x3D;</td>
</tr>
<tr>
<td>不等于</td>
<td>&lt;&gt;</td>
</tr>
<tr>
<td>小于</td>
<td>&lt;</td>
</tr>
<tr>
<td>大于</td>
<td>&gt;</td>
</tr>
<tr>
<td>小于等于</td>
<td>&lt;&#x3D;</td>
</tr>
<tr>
<td>大于等于</td>
<td>&gt;&#x3D;</td>
</tr>
<tr>
<td>对象引用比较</td>
<td>Is</td>
</tr>
</tbody></table>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><table>
<thead>
<tr>
<th>描述</th>
<th>符号</th>
</tr>
</thead>
<tbody><tr>
<td>逻辑非</td>
<td>Not</td>
</tr>
<tr>
<td>逻辑与</td>
<td>And</td>
</tr>
<tr>
<td>逻辑或</td>
<td>Or</td>
</tr>
<tr>
<td>逻辑异或</td>
<td>Xor</td>
</tr>
<tr>
<td>逻辑等价</td>
<td>Eqv</td>
</tr>
<tr>
<td>逻辑隐含</td>
<td>Imp</td>
</tr>
</tbody></table>
<p>当乘号与除号同时出现在一个表达式中时，按从左到右的顺序计算乘、除运算符。同样当加与减同时出现在一个表达式中时，按从左到右的顺序计算加、减运算符。<br>通过运行符，可以实现加，减，除等基本运算及大于，等于等比较操作。</p>
<h3 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h3><h4 id="分支流程"><a href="#分支流程" class="headerlink" title="分支流程"></a>分支流程</h4><p>好比遇到分叉路口，需要决定走哪条分支。</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Sub testIf()
    If (a &gt; 0) Then &#39;if 流程分支开始
        Debug.Print (&quot;a more than 0&quot;)
    ElseIf (a = 0) Then &#39;可以根据需要，添加0个或多个 ElseIf ... Then
        Debug.Print (&quot;a equals 0&quot;)
    Else &#39;剩下的流程
        Debug.Print (&quot;a less than 0&quot;)
    End If &#39;结束
End Sub
</code></pre>
<h4 id="循环流程"><a href="#循环流程" class="headerlink" title="循环流程"></a>循环流程</h4><p>重复执行某些操作</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Sub testFor()
    For i = 0 To 5 Step 2 &#39;每循环一次，i自增step，如没有添加step，默认step是1
        Debug.Print (i) &#39;可以使用 exit for退出for循环
    Next i
    Debug.Print (&quot;last i is : &quot; &amp; i)
End Sub
</code></pre>
<h3 id="过程与函数"><a href="#过程与函数" class="headerlink" title="过程与函数"></a>过程与函数</h3><h4 id="Sub-过程"><a href="#Sub-过程" class="headerlink" title="Sub 过程"></a>Sub 过程</h4><p>Sub 过程是包含在 Sub 和 End Sub 语句之间的一组 VBScript 语句，执行操作但不返回值。Sub 过程可以使用参数（由调用过程传递的常数、变量或表达式）。如果 Sub 过程无任何参数，则 Sub 语句必须包含空括号 ()。</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Sub testArray()
    Dim a
    a = Array(1, 2, 3)
    Debug.Print (a(0))
    Dim b(2)
    b(0) = 0
    b(1) = 1
    b(2) = 2
    Debug.Print (b(2))
End Sub
</code></pre>
<h4 id="Function-过程"><a href="#Function-过程" class="headerlink" title="Function 过程"></a>Function 过程</h4><p>Function 过程是包含在 Function 和 End Function 语句之间的一组 VBScript 语句。Function 过程与 Sub 过程类似，但是 Function 过程可以返回值。Function 过程可以使用参数（由调用过程传递的常数、变量或表达式）。如果 Function 过程无任何参数，则 Function 语句必须包含空括号 ()。Function 过程通过函数名返回一个值，这个值是在过程的语句中赋给函数名的。Function 返回值的数据类型总是 Variant。</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Function func_smp() As String
    func_smp = &quot;I am a simple function&quot;
End Function

Function func_param(ByVal x As Integer, ByRef y As Integer) As Integer
    func_param = x + y
End Function
</code></pre>
<h1 id="VBA-Excel综合实例"><a href="#VBA-Excel综合实例" class="headerlink" title="VBA + Excel综合实例"></a>VBA + Excel综合实例</h1><p>相信大家对前面的介绍有点烦了吧，我要学习的是VBA + Excel，干嘛整那么多枯燥乏味的VB呢？唉，其实我也不想的，不过，工欲善其事，必先利其器，先把基础学好了，打扎实了，总不会有错的，在现实生活中，要想学好一门知识，可不像武侠电视剧中，一下子学会九阳真经那么简单。下面就进入我们的实战练习吧。</p>
<h2 id="分析及设计"><a href="#分析及设计" class="headerlink" title="分析及设计"></a>分析及设计</h2><p>相当于打腹稿吧，程序不是你想的那样，想写就写，分析的过程就是理解用户的需求，用户需要什么，一定要弄清楚了。设计呢，就是考虑程序该怎么写，好比建一幢楼，需要先设计，并不是想怎么写就怎么写，与其它模块有什么接口啦，应该保护什么数据啦。这些都是需要事先考虑或协商好的。</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>需求很简单，就是用户输入TA的税前工资，然后可以计算出所扣的税，税后收入是多少，税率等级是多少。不过我在这里，多考虑一件事：税级。个税有两种，一种是含税级，一种是不含税级的，它们之间，除了计税等级不一样，其它的都是一样子滴。</p>
<h3 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h3><p>嗯，我想的是这样，我有一个类模块，在类模块初始化（创建）的时候，里面已经包含一些基本的信息了，如税率级，起征点，用户可以选择含税级或不含税级两种计税方式，不过，必须得事先设置好。然后用户输入一个数值，这个类可以计算出应缴纳的税款，税后收入，税率等级，关于计税算法呢，嗯，我就采用百度百科上的示例算法吧（根据对应的税率级按税率扣税，再减去速算扣除数）。然后我想，对应的税级，应缴税款，是根据税前工资决定的，你们可以读它，但是你不可以随意指定它（它必须是经过我计算得出的）。</p>
<p>我再想得长远一点，这个计算器，如果比较受欢迎的话，或者考虑到没有安装Office的人也能够应用。我得将数据，与界面分离，以达到代码的重复利用。嗯，暂时就想这么多吧，下面开始写我们的代码吧。</p>
<h2 id="VBA实战"><a href="#VBA实战" class="headerlink" title="VBA实战"></a>VBA实战</h2><h3 id="插入类模块"><a href="#插入类模块" class="headerlink" title="插入类模块"></a>插入类模块</h3><p>右键单击工程资源管理器中的任意地方，插入类模块。</p>
<img src="/2016/05/13/other/tech-vba-guide/image019.png" class="">
<p>并在属性窗口中将其重命名为：TaxPersonal。并双击此类模块，以打开代码编辑窗口。</p>
<h3 id="定义类属性"><a href="#定义类属性" class="headerlink" title="定义类属性"></a>定义类属性</h3><p>定义如起征点等属性。</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Const START = 3500 &#39;起征点
Const LEVEL_NUM = 7 &#39;总级数
Private pType As Integer &#39; 只允许写一次 0:含税级; 1:不含税级
Private pName As String &#39;只读属性
Private array_p1, array_p2, array_p &#39;range
Private array_rate &#39;rate
Private array_deduct &#39;deduct
Private pLevel &#39;level
Private pTax &#39;tax
Private pDiff As Single &#39;
Private pSalary &#39; salary before tax
</code></pre>
<p>这里，使用Private 声明变量，表示变量（属性）是私有的，别的工程不能访问它。</p>
<h3 id="添加构建函数"><a href="#添加构建函数" class="headerlink" title="添加构建函数"></a>添加构建函数</h3><p>定义一个构建函数，用来做一些初始化操作，比如税率。<br>在代码窗口中，选择上方的第一个下拉列表中选择Class，再在第二个下拉列表中选择Initialize，来生成构建函数。</p>

<p>注意，构建函数的名字是固定的，叫Class_initialize()<br>然后我们填入代码，注意到纳税额数组，其长度为级数减1，因为超过80000，我们不好定义一个具体的上限值。纯粹是算法上的考虑。</p>
<h3 id="定义计税Sub"><a href="#定义计税Sub" class="headerlink" title="定义计税Sub"></a>定义计税Sub</h3><p>我们定义一个方法来计算所得税</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">&#39; 计算个人所得税
Public Sub calc(beforeTax As Single)
  pSalary = CCur(beforeTax) &#39;转为货币类型
  If (pSalary &lt;= START) Then &#39;如果低于或等于起征点可以不用计算啦
    pLevel = -1
    pTax = 0
    pDiff = 0
  Else
    pDiff = pSalary - START &#39;计税部分
    If (pType = 0) Then &#39;含税级
      array_p = array_p1
    Else &#39;不含税级
      array_p = array_p2
    End If
    
    For i = 0 To LEVEL_NUM - 2 &#39; 只算到&lt;或=80000
      If (pDiff &lt;= CLng(array_p(i))) Then
        pLevel = i
        Exit For
      End If
    Next i
    
    If (i = LEVEL_NUM - 1) Then &#39;超过了最后一级
      pLevel = LEVEL_NUM - 1
    End If
    
    &#39; 使用计税公式计算扣税
    pTax = pDiff * array_rate(pLevel) / 100 - array_deduct(pLevel)
    
  End If
  
End Sub
</code></pre>
<p>定义属性读写方法</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">&#39; 获取税后收入
Public Function afterTax() As Single
  afterTax = pSalary - pTax
End Function

&#39; 获取缴纳的个人所得税
Public Property Get tax() As Currency
  tax = pTax
End Property

&#39; 获取个人所得税级别
Public Property Get level() As Integer
  level = pLevel + 1
End Property

&#39; 获取个人所得税计算公式
Public Property Get Expression() As String
  Expression = &quot;Level &quot; &amp; level &amp; &quot;:&quot; &amp; pSalary &amp; &quot; - ((&quot; _
  &amp; pSalary &amp; &quot; - &quot; &amp; START &amp; &quot;) * &quot; &amp; array_rate(pLevel) &amp; &quot;% - &quot; &amp; array_deduct(pLevel) &amp; &quot;)&quot;
End Property
</code></pre>
<p>注意：获取个人所得税公式函数中，因为字符太长，使用 _ 换行写了。</p>
<h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><p>插入一个新模块，名字定义为TaxCalucator，再写一个test Sub来测试及调试我们将才写的类。</p>
<p>在这里，我使用单步调试。</p>
<img src="/2016/05/13/other/tech-vba-guide/image029.png" class="">
<p>不知道细心的朋友，有没有发现代码中有一处bug呢？</p>
<p>呵呵，通过本地窗口，可以发现我鼠标选中的那一行，读取的level属性是不对滴，因为在未调用calc函数之前，它应该是默认的0才是。我在TaxPersonal类模块中定义的pLevel有效值是-1到6（内部定义，方便计算，因为数组下标是从0开始计算的），但给别人看的属性level是国家法律中规定的1到7。</p>
<p>可以自己想想，在哪里，应该怎么修复此bug。</p>
<h2 id="在Excel中调用VBA"><a href="#在Excel中调用VBA" class="headerlink" title="在Excel中调用VBA"></a>在Excel中调用VBA</h2><p>终于到最后一步了：将VBA应用到Excel上去。<br>首先在这里，特别讲一个Excel对象，其中ActiveSheet属性表示的是当前所在的WorkSheet。</p>
<p>其中一个WorkSheet又是由单元格所组成，最左上角的单元格，其行数为1，列数为1。可以通过Cells(row,column)来获取单元格对象。通过写Value属性来修改单元格的值。有了这些知识。就可以很快地将TaxPersonal应用到表格上去了。</p>
<h3 id="新增AutoCalc-Sub"><a href="#新增AutoCalc-Sub" class="headerlink" title="新增AutoCalc Sub"></a>新增AutoCalc Sub</h3><p>双击Sheet 1（2012个人所得税计算器）Sheet，添加AutoCalc Sub用来自动计算个税。代码如下：</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">
Private Sub AutoCalc()
  On Error GoTo ErrorHandle
  Dim total, deduct, beforeTax, levelText
  Dim taxObj As New TaxPersonal
  levelText = Array(&quot;很抱歉，您还没有纳税资格！&quot;, _
  &quot;恭喜您，你已成为了国家纳税人！&quot;, &quot;恭喜您，您应该是温饱不愁了吧？&quot;, _
  &quot;恭喜您，您已经迈入小康了！&quot;, &quot;恭喜您，好好享受一下小资情调吧！&quot;, &quot;恭喜您，您的收入已经达到中产阶级水平了&quot;, _
  &quot;恭喜您，您已经为成了名符其实的资产阶级&quot;, &quot;恭喜您，国家会感谢您为国家所做的贡献的！&quot;)
  
  total = Me.Cells(2, 2).value
  deduct = Me.Cells(3, 2).value
  If (IsNumeric(total)) Then
    Cells(9, 1).value = &quot;&quot;
    If (IsNumeric(deduct)) Then
      Cells(9, 1).value = &quot;&quot;
      beforeTax = CSng(total) - CSng(deduct)
      taxObj.calc (beforeTax)
      &#39;Me.Cells(5, 2).value = beforeTax - taxObj.tax &#39; 我用Excel公式了，没使用VBA
      Me.Cells(6, 2).value = taxObj.level &#39;税级
      Me.Cells(6, 3).value = taxObj.Expression
      Me.Cells(7, 2).value = taxObj.tax
      Me.Cells(7, 3).value = levelText(taxObj.level) &#39;根据税级给出一个个性化的提示
      Me.Cells(8, 2).value = taxObj.afterTax &#39;税后收入
      
    Else
      Cells(9, 1).value = &quot;请输入有效的扣除项&quot;
    End If
  Else
    Cells(9, 1).value = &quot;请输入有效的税前收入&quot;
  End If
  
  Exit Sub
ErrorHandle:
  Cells(9, 1).value = &quot;哇，恭喜您为我找到一个BUG，错误：&quot; &amp; Err.Description &amp; &quot;，类型：&quot; &amp; Err.Number
  Err.Clear &#39;最后别忘了清除Error对象

End Sub
</code></pre>
<p>注意，我在代码中还添加了一个错误处理，当有错误产生时，会在最后一行中给出一些错误信息。如果有人发现了bug，可以将输入信息及错误信息发送到<a href="mailto:&#x6c;&#105;&#46;&#106;&#x61;&#x6d;&#x6c;&#x69;&#x6e;&#103;&#64;&#x67;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#109;">&#x6c;&#105;&#46;&#106;&#x61;&#x6d;&#x6c;&#x69;&#x6e;&#103;&#64;&#x67;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#109;</a></p>
<h3 id="调用AutoCalc-Sub"><a href="#调用AutoCalc-Sub" class="headerlink" title="调用AutoCalc Sub"></a>调用AutoCalc Sub</h3><p>什么时候触发此Sub呢，我想单元格变更的时候吧，这样，当用户输入完税前工资后，就可以立即自动计算了。</p>
<p class="code-caption" data-lang="vbscript" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p>

<pre><code class="vbscript">Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  AutoCalc
End Sub
</code></pre>
<p>选择WorkSheet的SelectionChange Sub，在Sub中调用AutoCalc Sub就可以了。</p>
<h2 id="VBA工程的签名"><a href="#VBA工程的签名" class="headerlink" title="VBA工程的签名"></a>VBA工程的签名</h2><h3 id="签名的好处"><a href="#签名的好处" class="headerlink" title="签名的好处"></a>签名的好处</h3><p>为什么要签名呢？因为Office默认的宏安全级别为高，如果你的VBA工程未签名，那么默认情况下，此宏是被禁用的。</p>
<p>签名之后，在打开有宏的Excel时，会弹出一个警告框，如下图所示：</p>
<img src="/2016/05/13/other/tech-vba-guide/image035.png" class="">
<p>在勾选“总是相信来自此发布者的宏（A）”复选框时，下边的“启用宏(E)”按钮才可以点击。</p>
<p>数字签名，还可以保护代码不被修改，如果代码修改过了，那么签名校验就不会通过。</p>
<h3 id="签名过程"><a href="#签名过程" class="headerlink" title="签名过程"></a>签名过程</h3><p>开始→程序→Microsoft Office→Microsoft Office工具→VBA项目的数字证书。</p>
<img src="/2016/05/13/other/tech-vba-guide/image037.png" class="">
<img src="/2016/05/13/other/tech-vba-guide/image039.png" class="">
<p>输入您的证书名称后确定。<br>在VBA 编辑器中，菜单栏工具→数字签名→选择刚才创建的证书即可。</p>
<h3 id="VBA宏保护"><a href="#VBA宏保护" class="headerlink" title="VBA宏保护"></a>VBA宏保护</h3><p>通过VBA的工程属性，可以设置一个工程进入密码，可以防止别人查看，修改你的VBA代码</p>
<p>工具→工程属性，点击保护选项卡，输入工程保护密码即可</p>
<img src="/2016/05/13/other/tech-vba-guide/image041.png" class=""> 

<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>在熟悉VBA之后，使用VBA实现一个《个体工商户的生产经营所得税计算器》。附录工程中包含答案。</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>完整工程<br>个人所得税计算器VBA工程：<a href="/2016/05/13/other/tech-vba-guide/%E4%B8%AA%E4%BA%BA%E6%89%80%E5%BE%97%E7%A8%8E%E8%AE%A1%E7%AE%97%E5%99%A8.xls" title="个人所得税计算器.xls">个人所得税计算器.xls</a></p>
<h1 id="关于作者"><a href="#关于作者" class="headerlink" title="关于作者"></a>关于作者</h1><p>Jamling，男，资深宅男，85年生，目前就职于南京一家软件公司，主要从事Java软件设计及研发。在工作之余，喜欢搞一些与软件相关的研究性课题，姑且算是一名技术宅吧。</p>
<p>Email: <a href="mailto:&#108;&#105;&#x2e;&#106;&#x61;&#109;&#x6c;&#x69;&#x6e;&#x67;&#64;&#x67;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#109;">&#108;&#105;&#x2e;&#106;&#x61;&#109;&#x6c;&#x69;&#x6e;&#x67;&#64;&#x67;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#109;</a></p>
<p>注：<br>后面我可能会再制作Excel VBA高级教程，面向的读者是已有VBA基础的读者。</p>
<blockquote class="addlink">本文永久链接： [https://www.ieclipse.cn/2016/05/13/other/tech-vba-guide/](https://www.ieclipse.cn/2016/05/13/other/tech-vba-guide/) 未经允许，禁止转载，如有问题，请在我的博客原始页面提交评论。</blockquote>
  
  </div>

  
<script src="/js/decrypt.min.js"></script>

  <footer class="article-footer">
    <time class="article-footer-updated" datetime="2019-07-22T11:25:01.979Z" itemprop="dateModified">
    最后更新：2019-07-22
    </time>
    <span itemprop="author publisher" itemscope="itemscope" itemtype="http://schema.org/Organization">
      <meta content="https://www.ieclipse.cn" itemprop="url">
      <meta content="静勤居" itemprop="name">
      <meta content="/image/logo.png" itemprop="logo">
    </span>
    
<a id="share"></a>
<div class="social-share"></div>
<script>
with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js'];
</script>


  </footer>
</article>

<div class="page-footer">
  <nav><ul class="pager"><li class="previous"><a href="/2016/05/14/other/tech-gerrit-install/"><span aria-hidden="true">&larr;</span><span class="hidden-xs">上一页</span></a></li><li class="next"><a href="/2016/03/04/Web/Hexo-your-blog/"><span aria-hidden="true">&rarr;</span><span class="hidden-xs">下一页</span></a></li></ul></nav>
  
<!-- Button trigger modal -->
<blockquote class="donate"><!--
  <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#DonateModal">
    打赏
  </button>-->
  <p>
  <a href="#" role="button" data-toggle="modal" data-target="#DonateModal">
  <img src="/image/donate_button.png" alt="donate">
  <span>各位看官，鄙人借网络这块宝地在此献丑，望有钱的捧个钱场（打赏任意金额），没钱的捧个人场（分享）</span></a>
  </p>
</blockquote>
<!-- Modal -->
<div class="modal fade" id="DonateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <span class="modal-title" id="myModalLabel">打赏</span>
      </div>
      <div class="modal-body"><!--
        <table>
        <thead>
          <th class="text-center">支付宝</th>
          <th class="text-center">微信支付</th>
        </thead>
        <tr>
          <td><img src="/image/donate_alipay.png" alt="使用支付宝扫码打赏" class="img-rounded donate" width="200" height="200"></td>
          <td><img src="/image/donate_wechat.png" alt="使用微信扫码打赏" class="img-rounded donate" width="200" height="200"></td>
        </tr>
        </table>-->
        <div class="container-fluid">
        <div class="row">
        <div class="col-md-6">
          <div class="text-center">
            <span style="display:block;">支付宝</span>
            <img src="/image/donate_alipay.png" alt="使用支付宝扫码打赏" class="donate" />
          </div>
        </div>
        <div class="col-md-6">
          <div class="text-center">
            <span style="display:block;">微信支付</span>
            <img src="/image/donate_wechat.png" alt="使用微信扫码打赏" class="donate" />
          </div>
        </div>
        </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

  <a id="comment"></a>

<script src="//unpkg.com/valine/dist/Valine.min.js">
</script>
<!--PC和WAP自适应版-->
<div id="vcomments" data-sid="1173caa5a2793a07589a12dc3b079b4c" ></div>
<script>
    new Valine({
        av: AV,
        el: '#vcomments',
        appId: 'C45xzaBLva5G5IfKxOwGXuVb-gzGzoHsz',
        appKey: 'QwGBjKlSYOBtjMa5aTGeO3cb',
        path: '2016/05/13/other/tech-vba-guide/',
        recordIP: true,
        visitor: false
    })
</script>



</div>


    
  </div> <!-- end main column  -->
  <!-- aside -->
  <div class="col-sx-12 col-sm-4 col-md-3 col-lg-3">
    <aside>
      <div id="navbar-toc">
      <nav id="toc" class="hidden-print hidden-xs hidden-sm" data-spy="affix">
        <div class="toc-title"><a role="button" data-toggle="collapse" href="#toc-body" aria-expanded="true">
          目录
        </a></div>
        <div id="toc-body" class="in">
        <ul class="nav toc-ul"><li><a href="#VBA简介">VBA简介</a><ul class="nav toc-ul"><li><a href="#VBA">VBA</a></li><li><a href="#宏与VBA">宏与VBA</a></li></ul></li><li><a href="#教程目的">教程目的</a></li><li><a href="#准备工作">准备工作</a></li><li><a href="#VBA-for-Excel">VBA for Excel</a><ul class="nav toc-ul"><li><a href="#VBA编辑器简介">VBA编辑器简介</a><ul class="nav toc-ul"><li><a href="#打开VBA编辑器">打开VBA编辑器</a></li><li><a href="#工程资源管理器">工程资源管理器</a></li><li><a href="#属性窗口">属性窗口</a></li><li><a href="#代码窗口">代码窗口</a></li><li><a href="#立即窗口">立即窗口</a></li><li><a href="#本地窗口">本地窗口</a></li><li><a href="#调试工具栏">调试工具栏</a></li></ul></li><li><a href="#VBA语法">VBA语法</a><ul class="nav toc-ul"><li><a href="#数据类型">数据类型</a><ul class="nav toc-ul"><li><a href="#Variant-子类型">Variant 子类型</a></li></ul></li><li><a href="#变量定义">变量定义</a><ul class="nav toc-ul"><li><a href="#变量声明">变量声明</a></li><li><a href="#变量赋值">变量赋值</a></li></ul></li><li><a href="#运算符">运算符</a><ul class="nav toc-ul"><li><a href="#算术运算符">算术运算符</a></li><li><a href="#比较运算符">比较运算符</a></li><li><a href="#逻辑运算符">逻辑运算符</a></li></ul></li><li><a href="#流程控制">流程控制</a><ul class="nav toc-ul"><li><a href="#分支流程">分支流程</a></li><li><a href="#循环流程">循环流程</a></li></ul></li><li><a href="#过程与函数">过程与函数</a><ul class="nav toc-ul"><li><a href="#Sub-过程">Sub 过程</a></li><li><a href="#Function-过程">Function 过程</a></li></ul></li></ul></li></ul></li><li><a href="#VBA-Excel综合实例">VBA + Excel综合实例</a><ul class="nav toc-ul"><li><a href="#分析及设计">分析及设计</a><ul class="nav toc-ul"><li><a href="#分析">分析</a></li><li><a href="#设计">设计</a></li></ul></li><li><a href="#VBA实战">VBA实战</a><ul class="nav toc-ul"><li><a href="#插入类模块">插入类模块</a></li><li><a href="#定义类属性">定义类属性</a></li><li><a href="#添加构建函数">添加构建函数</a></li><li><a href="#定义计税Sub">定义计税Sub</a></li><li><a href="#调试">调试</a></li></ul></li><li><a href="#在Excel中调用VBA">在Excel中调用VBA</a><ul class="nav toc-ul"><li><a href="#新增AutoCalc-Sub">新增AutoCalc Sub</a></li><li><a href="#调用AutoCalc-Sub">调用AutoCalc Sub</a></li></ul></li><li><a href="#VBA工程的签名">VBA工程的签名</a><ul class="nav toc-ul"><li><a href="#签名的好处">签名的好处</a></li><li><a href="#签名过程">签名过程</a></li><li><a href="#VBA宏保护">VBA宏保护</a></li></ul></li><li><a href="#练习">练习</a></li><li><a href="#附录">附录</a></li></ul></li><li><a href="#关于作者">关于作者</a></li></ul>
        </div>
      </nav>
</div>

      
    </aside>
  </div> <!-- end aside column  -->
</div> <!-- end row -->
</div> <!-- end container -->

  <!-- footer -->
  <footer id="body-footer">
  <div class="divider"></div>
  <div>&nbsp;</div>
  <div class="inner text-center">
    <div id="footer-copyright">
      &copy; 2022 <a href="https://www.ieclipse.cn" target="_blank">Jamling</a> powered by <a href="http://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Jamling/hexo-theme-nova" target="_blank">Nova</a><br>
      <!-- Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>. -->
    </div>
    <div>
      <a href="//beian.miit.gov.cn" target="_blank">苏ICP备15019510号</a>
    </div>
  </div>
</footer>

  <!-- fixed action bar -->
  
  <div class="fab hidden-print" style="bottom: 45px; right: 24px;">
  <!--
    <ul class="top-expand" id="top-expand">
      <li><a class="fab-item large red" href="#top"><i class="icon nova-top"></i></a></li>
      <li><a class="fab-item large yellow " href="//www.jiathis.com/share?uid=2064663" target="_blank"><i class="icon nova-share"></i></a></li>
    </ul>
    <a class="fab-item large red " onclick="$('#top-expand').toggle();">
      <i class="icon nova-list-ul"></i>
    </a>
    -->
    <a class="fab-item large red " href="#top">
      <i class="icon nova-top"></i>
    </a>
  </div>

  <!-- after footer, some 3rd script place here -->
    <script>
    var hljs_labels = {
        left: "代码",
        right: "如下：",
        copy: "复制"
    }
    </script>
    
<script src="/js/hljs.js"></script>

    
<script src="/js/script.js"></script>

    
    
<script>
  lc.countCounter({});

  lc.countComment({
    index: false
  });
</script>
</body>
</html>
